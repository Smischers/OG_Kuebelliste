<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edith</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="edith.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>

<body>
    <div id="app">
        <form id="createListForm">
            <div class="imgcontainer center">
                <img src="../resources/logoSVG.png" title="Kübelliste Logo" alt="To-Do Liste in Kübel"
                    class="logoLogin">
            </div>

            <div class="container"
                style="max-width: 40%;border: 2px solid #00838f; padding: 20px 30px; border-radius: 5%;">
                <h1 style="margin-top: 0; font-size: 150%;" class="center"><b>{{ this.listName }}</b></h1>
                <h2 style="margin-top: 0; font-size: 100%" class="center"><b>{{ this.listEntryName }}</b></h2>

                <label for="category"><b>Category</b></label>
                <select name="category" id="category" style="display: block;" required>
                    <option value="To-Do">To-Do</option>
                    <option value="Done">Done</option>
                </select>

                <label for="entryName"><b>Entry name</b></label>
                <input type="text" id="entryName" name="entryName" :value=this.listEntryName required>
                <label for="rating"><b>Rating</b></label>
                <input type="text" id="rating" name="rating" required>
                <label for="description"><b>Description</b></label>
                <input type="text" id="description" name="description" required>
                <label for="deadline"><b>Deadline</b></label>
                <input type="text" id="deadline" name="deadline" required>

                <label for="listPicture"><b>Picture URL</b></label>
                <input type="text" id="listPicture" name="listPicture">

                <button type="submit" class="waves-effect waves-light btn cyan darken-3">Submit</button>
                <a :href="`listview.html?listName=${this.listName}`"><button type="button"
                        class="cancelbtn waves-effect waves-light btn grey">Cancel</button></a>
                <button v-on:click=deleteEntry() type="button"
                        class="deletebtn waves-effect waves-light btn red">Delete</button>
            </div>
        </form>
    </div>
    <script>
        new Vue({
            el: '#app',
            data: {
                listName: "",
                listEntryName: "",
                listCategory: "",
            },
            methods: {
                fetchItems() {
                    let fetchedItems = [];

                    /**fetch("/list")
                        .then(res => res.json())
                        .then(data => {
                            fetchedItems = data;
                            fetchedItems.push({
                                name: "New List", picture: "../resources/Plus_symbol.png",
                            })
                        })
                        .then(list => {
                            this.items = fetchedItems
                            console.log(fetchedItems)
                        }
                        )
                        .catch(err => console.log(err));**/

                },
                deleteEntry() {
                    let fetchedItems = [];


                    fetch(`/list/${this.listName}/${this.listCategory}/${this.listEntryName}`,{
                        method: 'DELETE',
                    })
                        .then(data => {
                            if (data.status === 200) {
                                window.location.href = `listview.html?listName=${this.listName}`;
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                        });

                }
            },
            mounted() {
                const params = new URLSearchParams(window.location.search);
                const listName = params.get('listName');
                const listParam = params.get('listEntry');
                const listCategory = params.get('category');
                if (listParam) {
                    this.listName = listName;
                    this.listEntryName = listParam;
                    this.listCategory = listCategory;
                    this.fetchItems();
                }
            }
        });
    </script>
    <script>/**
    document.getElementById('createListForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const formData = {
            name: document.getElementById('listName').value,
            picture: document.getElementById('listPicture').value,
            weather: document.getElementById('weather').value
        };
        console.log(formData)

        fetch('/list', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
            .then(data => {
                fetch(`/list/${formData.name}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify([{ name: "To-Do" }])
                })
                    .catch(error => {
                        console.log('Error:', error);
                        window.location.href = 'index.html'
                    })
            })
            .then(data => window.location.href = 'index.html')
            .catch(error => {
                console.error('Error:', error);
                alert('Login failed. Please check your credentials and try again.');
            });
    });**/
    </script>
</body>

</html>