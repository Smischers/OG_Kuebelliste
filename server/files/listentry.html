<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KÃ¼belliste!</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="index.css" />
  <link rel="icon" type="image/x-icon" href="resources/Kuebelliste_Icon.png">
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
</head>

<body>
  <div id="app">
    <header>
      <!-- NAVBAR -->
      <navbar></navbar>
    </header>

    <div class="nav-wrapper col s12" style="padding-left: 40px; line-height: 56px;">
      <a href="index.html" class="breadcrumb">My Lists</a>
      <a :href="`listview.html?listName=${ listName }`" class="breadcrumb">{{ listName }}</a>
      <a class="breadcrumb">
        {{ listEntry}}
      </a>
      <a :href="`listentryEdith.html?listName=${this.listName}&category=${this.category}&listEntry=${this.listEntry}`"
        title="Edit entry" class="listSettings"><i class="material-icons">settings</i></a>
    </div>

    <main>
      <!-- here comes data -->
      <div id="myDiv" style="width: 70%; background-color: #f5f5f5; padding: 1.5%; margin-bottom: 3%; float: left;">
        <h1 style="padding-bottom: 2%;"><b>{{ items.name }}</b></h1>
        <ul class="listEntryList" style="padding-left: 1.5%;">
          <li><b>Rating: </b>{{ items.rating }}</li>
          <li><b>Description: </b>{{ items.description }}</li>
          <li><b>Deadline: </b>{{ items.deadline }}</li>
          <li><b>Added to calendar: </b>{{ items.calendar }}</li>
        </ul>
      </div>
      <img :src="items.image" id="myImg" class="materialboxed"
        style="max-width: 25% !important; height: auto !important; float: right !important; display: block !important;">
    </main>

    <!-- OUR FOOTER-->
    <kuebelfooter></kuebelfooter>

  </div>

  <script>
    // Dynamic min-height of div
    document.addEventListener("DOMContentLoaded", function () {
      function updateDivHeight() {
        // Get height of img
        const imgElement = document.getElementById('myImg');
        const imgHeight = imgElement.offsetHeight;

        // Set height of div based on img dynamically
        const divElement = document.getElementById('myDiv');
        divElement.style.minHeight = imgHeight + 'px';
      }

      // Initial call of function on windowload
      updateDivHeight();

      // Checking for updates
      const observer = new MutationObserver(updateDivHeight);
      observer.observe(document.getElementById('myImg'), { childList: true, subtree: true });

      // Resize-Eventhandler
      window.addEventListener('resize', updateDivHeight);
    });

    document.addEventListener('DOMContentLoaded', function () {
      var elems = document.querySelectorAll('.materialboxed');
      var instances = M.Materialbox.init(elems, {});
    });
  </script>

  <script src="components.js"></script>
  <script>
    new Vue({
      el: '#app',
      data: {
        listName: "test",
        items: {},
        listEntry: "",
        category: ""
      },
      computed: {
      },
      methods: {
        fetchItems() {
          // Simulate an API call
          const fetchedItems = [
            {
              "name": "Coral Aerie",
              "rating": "0 / 6",
              "description": "The Coral Aerie dungeon was added to the game with Update 33 Ascending Tide DLC. It features both Normal and Veteran modes, as well as Hardmodes for each boss and secret bosses. Players can either use the Group & Activity Finder in order to enter the dungeon as a 4 player group, or select it from the northern Summerset map. Coral Aerie has 7 bosses: 3 main bosses with each having a hardmode, 4 secret bosses and trashmob packs.",
              "deadline": "30.03.2024",
              "calendar": "yes",
              "image": "https://images.uesp.net/thumb/1/1b/ON-map-Coral_Aerie_02.jpg/600px-ON-map-Coral_Aerie_02.jpg"
            }
          ]

          this.items = fetchedItems[0]
        },
      },
      mounted() {
        this.fetchItems();

        const params = new URLSearchParams(window.location.search);
        this.listName = params.get('listName');
        this.listEntry = params.get('listEntry');
        this.category = params.get('listCategory');
      }
    });


  </script>
</body>

</html>